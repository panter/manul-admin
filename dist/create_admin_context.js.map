{"version":3,"sources":["../src/create_admin_context.js"],"names":["Meteor","ValidatedMethod","LocalState","config","adminRoutes","components","gotoRoute","routeName","window","alert","neededMeteorPackages","Error","join","methods","getComponent","collectionName","type","Component","default","displayName","routeUtils","publicationUtils"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA;;;;AACA;;;;AACA;;;;AACA;;;;;;kBAGe,gBAaC;AAAA,MAXdA,MAWc,QAXdA,MAWc;AAAA,MAVdC,eAUc,QAVdA,eAUc;AAAA,MATdC,UASc,QATdA,UASc;AAAA,MARdC,MAQc,QARdA,MAQc;AAAA,MAPdC,WAOc,QAPdA,WAOc;AAAA,MANdC,UAMc,QANdA,UAMc;AAAA,4BAJdC,SAIc;AAAA,MAJdA,SAIc,kCAJF,UAACC,SAAD;AAAA,WACVC,OAAOC,KAAP,2EAC0EF,SAD1E,CADU;AAAA,GAIE;;AACd,8BAAeF,UAAf;;AAEA,MAAMK,uBAAuB,EAAEV,cAAF,EAAUC,gCAAV,EAA2BC,sBAA3B,EAA7B;AACA,MAAI,oBAAOQ,oBAAP,kBAAJ,EAA2C;AACzC,UAAM,IAAIC,KAAJ,mEAE6B,oBAAOD,oBAAP,EAA6BE,IAA7B,CAAkC,IAAlC,CAF7B,CAAN;AAID;;AAED,MAAMC,UAAU,2BAAY;AAC1Bb,kBAD0B;AAE1BC,oCAF0B;AAG1BE;AAH0B,GAAZ,CAAhB;AAKA,MAAMW,eAAe,SAAfA,YAAe,QAMf;AAAA,QALJC,cAKI,SALJA,cAKI;AAAA,QAJJC,IAII,SAJJA,IAII;;AACJ,QAAIC,YAAY,IAAhB;AACA,QAAI,0BAAaZ,WAAWW,IAAX,CAAb,CAAJ,EAAoC;AAClCC,kBAAYZ,WAAWW,IAAX,CAAZ;AACD,KAFD,MAEO,IAAI,mBAAMX,UAAN,EAAkB,CAACW,IAAD,EAAOD,cAAP,CAAlB,CAAJ,EAA+C;AACpDE,kBAAYZ,WAAWW,IAAX,EAAiBD,cAAjB,CAAZ;AACD,KAFM,MAEA;AACLE,kBAAYZ,WAAWW,IAAX,EAAiBE,OAA7B;AACD;AACDD,cAAUE,WAAV,cAAiCJ,cAAjC,SAAmDC,IAAnD;AACA,WAAOC,SAAP;AACD,GAjBD;AAkBA,SAAO;AACLjB,kBADK;AAELE,0BAFK;AAGLW,oBAHK;AAILC,8BAJK;AAKLX,kBALK;AAMLC,4BANK;AAOLE,wBAPK;AAQLD,0BARK;AASLe,qCATK;AAULC;AAVK,GAAP;AAYD,C","file":"create_admin_context.js","sourcesContent":["// @flow\nimport _ from 'lodash';\n\nimport initMethods from './initMethods';\nimport defaultComponents from './default_components';\nimport publicationUtils from './utils/publication_utils';\nimport routeUtils from './utils/route_utils';\nimport type { ContextT, CollectionNameT, ComponentTypeT } from './types';\n\nexport default ({\n  // needed meteor dependencies\n  Meteor,\n  ValidatedMethod,\n  LocalState,\n  config, // admin config\n  adminRoutes, // FlowRouter, manulRouter compatible routes\n  components, // component definition, see readme\n  /* eslint no-alert: 0*/\n  gotoRoute = (routeName: string) =>\n    window.alert(\n      `please provide a gotoRoute-function in adminContext that can jump to ${routeName}`\n    )\n}: ContextT) => {\n  _.defaultsDeep(components, defaultComponents);\n\n  const neededMeteorPackages = { Meteor, ValidatedMethod, LocalState };\n  if (_.some(neededMeteorPackages, _.isNil)) {\n    throw new Error(\n      `please provide all of \n      the following meteor-packages: ${_.keys(neededMeteorPackages).join(', ')}`\n    );\n  }\n\n  const methods = initMethods({\n    Meteor,\n    ValidatedMethod,\n    config\n  });\n  const getComponent = ({\n    collectionName,\n    type\n  }: {\n    collectionName: CollectionNameT,\n    type: ComponentTypeT\n  }) => {\n    let Component = null;\n    if (_.isFunction(components[type])) {\n      Component = components[type];\n    } else if (_.has(components, [type, collectionName])) {\n      Component = components[type][collectionName];\n    } else {\n      Component = components[type].default;\n    }\n    Component.displayName = `Admin_${collectionName}_${type}`;\n    return Component;\n  };\n  return {\n    Meteor,\n    LocalState,\n    methods,\n    getComponent,\n    config,\n    adminRoutes,\n    gotoRoute,\n    components,\n    routeUtils,\n    publicationUtils\n  };\n};\n"]}