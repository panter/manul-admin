{"version":3,"sources":["../../src/initMethods/destroy.js"],"names":["collectionName","collectionConfig","ValidatedMethod","Meteor","name","validate","_id","type","String","validator","clean","run","userId","Error","collection","remove"],"mappings":";;;;;;AACA;;;;AACA;;;;;;kBAQe,gBAEbA,cAFa,EAGbC,gBAHa;AAAA,MACXC,eADW,QACXA,eADW;AAAA,MACMC,MADN,QACMA,MADN;AAAA,SAKb,IAAID,eAAJ,CAAoB;AAClBE,0BAAoBJ,cAApB,aADkB;AAElBK,cAAU,0BAAiB,EAAEC,KAAK,EAAEC,MAAMC,MAAR,EAAP,EAAjB,EAA4CC,SAA5C,CAAsD;AAC9DC,aAAO;AADuD,KAAtD,CAFQ;AAKlBC,OALkB,sBAKL;AAAA,UAAPL,GAAO,SAAPA,GAAO;;AACX;AACA,UAAI,CAAC,0BAAUN,cAAV,EAA0B,KAAKY,MAA/B,CAAL,EAA6C;AAC3C,cAAM,IAAIT,OAAOU,KAAX,CAAiB,aAAjB,EAAgC,qBAAhC,CAAN;AACD;AACD,aAAOZ,iBAAiBa,UAAjB,CAA4BC,MAA5B,CAAmCT,GAAnC,CAAP;AACD;AAXiB,GAApB,CALa;AAAA,C","file":"destroy.js","sourcesContent":["// @flow\nimport SimpleSchema from 'simpl-schema';\nimport isAllowed from '../is_allowed';\n\nimport type {\n  MethodsContextT,\n  CollectionNameT,\n  CollectionConfigT\n} from '../types';\n\nexport default (\n  { ValidatedMethod, Meteor }: MethodsContextT,\n  collectionName: CollectionNameT,\n  collectionConfig: CollectionConfigT\n) =>\n  new ValidatedMethod({\n    name: `manulAdmin.${collectionName}.destroy`,\n    validate: new SimpleSchema({ _id: { type: String } }).validator({\n      clean: true\n    }),\n    run({ _id }) {\n      // console.log('inserting', doc);\n      if (!isAllowed(collectionName, this.userId)) {\n        throw new Meteor.Error('not allowed', 'You are not allowed');\n      }\n      return collectionConfig.collection.remove(_id);\n    }\n  });\n"]}