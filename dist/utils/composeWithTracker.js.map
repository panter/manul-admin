{"version":3,"sources":["../../src/utils/composeWithTracker.js"],"names":["composeWithTracker","myCompose","pure","withRef","reactiveFn","options","onPropsChange","props","onData","context","Meteor","isServer","trackerCleanup","handler","Tracker","nonreactive","autorun","stop"],"mappings":";;;;;kBASwBA,kB;;AATxB;;AAEA,IAAMC,YAAY,gCAAY;AAC5BC,QAAM,IADsB;AAE5BC,WAAS;AAFmB,CAAZ,CAAlB;;AAKA;;AAEe,SAASH,kBAAT,CAA4BI,UAA5B,EAAwCC,OAAxC,EAAiD;AAC9D,MAAMC,gBAAgB,SAAhBA,aAAgB,CAACC,KAAD,EAAQC,MAAR,EAAgBC,OAAhB,EAA4B;AAChD,QAAIC,OAAOC,QAAX,EAAqB;AACnBP,iBAAWG,KAAX,EAAkBC,MAAlB,EAA0BC,OAA1B;AACA,aAAO;AAAA,eAAM,IAAN;AAAA,OAAP;AACD;AACD,QAAIG,uBAAJ;AACA,QAAMC,UAAUC,QAAQC,WAAR,CAAoB;AAAA,aAClCD,QAAQE,OAAR,CAAgB,YAAM;AACpBJ,yBAAiBR,WAAWG,KAAX,EAAkBC,MAAlB,EAA0BC,OAA1B,CAAjB;AACD,OAFD,CADkC;AAAA,KAApB,CAAhB;;AAMA,WAAO,YAAM;AACX,UAAI,OAAOG,cAAP,KAA0B,UAA9B,EAA0C;AACxCA;AACD;AACD,aAAOC,QAAQI,IAAR,EAAP;AACD,KALD;AAOD,GAnBD;;AAqBA,SAAOhB,UACLK,aADK,EAELD,OAFK,CAAP;AAID","file":"composeWithTracker.js","sourcesContent":["import { setDefaults } from '@storybook/react-komposer';\n\nconst myCompose = setDefaults({\n  pure: true,\n  withRef: false,\n});\n\n/* global Tracker, Meteor */\n\nexport default function composeWithTracker(reactiveFn, options) {\n  const onPropsChange = (props, onData, context) => {\n    if (Meteor.isServer) {\n      reactiveFn(props, onData, context);\n      return () => null\n    }\n    let trackerCleanup;\n    const handler = Tracker.nonreactive(() =>\n      Tracker.autorun(() => {\n        trackerCleanup = reactiveFn(props, onData, context);\n      })\n    );\n\n    return () => {\n      if (typeof trackerCleanup === 'function') {\n        trackerCleanup();\n      }\n      return handler.stop();\n    };\n\n  };\n\n  return myCompose(\n    onPropsChange,\n    options\n  );\n}"]}