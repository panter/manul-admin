{"version":3,"sources":["../../src/utils/export_utils.js"],"names":["getTransform","fieldsToExport","isEmptyObject","field","isFieldToExport","val","key","removeEmptyObjects","doc","pickFieldsToExport","length","transform","getExportSet","allDocs","data","keysSet","forEach","entry","add","keys","values","console","log"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;AAcA,IAAMA,eAAe,SAAfA,YAAe,OAAwB;AAAA,MAArBC,cAAqB,QAArBA,cAAqB;;AAC3C,MAAMC,gBAAgB,SAAhBA,aAAgB;AAAA,WACpB,wBAASC,KAAT,KAAmB,CAAC,sBAAOA,KAAP,CAApB,IAAqC,uBAAQA,KAAR,CADjB;AAAA,GAAtB;AAEA,MAAMC,kBAAkB,SAAlBA,eAAkB,CAACC,GAAD,EAAMC,GAAN;AAAA,WAAc,uBAAQA,GAAR,EAAaL,cAAb,KAAgC,CAA9C;AAAA,GAAxB;AACA,MAAMM,qBAAqB,SAArBA,kBAAqB;AAAA,WAAO,sBAAOL,aAAP,EAAsBM,GAAtB,CAAP;AAAA,GAA3B;AACA,MAAMC,qBAAqB,SAArBA,kBAAqB;AAAA,WACzBR,eAAeS,MAAf,GAAwB,CAAxB,GAA4B,sBAAON,eAAP,EAAwBI,GAAxB,CAA5B,GAA2DA,GADlC;AAAA,GAA3B;;AAGA,MAAMG,YAAY,oBAChB,kCADgB,EAEhB,mBAAIF,kBAAJ,CAFgB,EAGhB,mBAAIF,kBAAJ,CAHgB,CAAlB;;AAMA,SAAOI,SAAP;AACD,CAfD;AAgBA;AACO,IAAMC,sCAAe,SAAfA,YAAe,CAACC,OAAD,SAAiC;AAAA,MAArBZ,cAAqB,SAArBA,cAAqB;;AAC3D,MAAMU,YAAYX,aAAa,EAAEC,8BAAF,EAAb,CAAlB;AACA,MAAMa,OAAOH,UAAUE,OAAV,CAAb;;AAEA,MAAME,UAAU,mBAAhB;AACAD,OAAKE,OAAL,CAAa;AAAA,WAAS,oBAAWC,KAAX,EAAkBD,OAAlB,CAA0B;AAAA,aAAOD,QAAQG,GAAR,CAAYZ,GAAZ,CAAP;AAAA,KAA1B,CAAT;AAAA,GAAb;AACA,MAAMa,kDAAWJ,QAAQK,MAAR,EAAX,EAAN;AACAC,UAAQC,GAAR,CAAYT,OAAZ,EAAqBZ,cAArB,EAAqCkB,IAArC;AACA,SAAO,EAAEL,UAAF,EAAQK,UAAR,EAAP;AACD,CATM","file":"export_utils.js","sourcesContent":["import flat from 'flat';\n\nimport {\n  isObject,\n  isDate,\n  isEmpty,\n  indexOf,\n  omitBy,\n  pickBy,\n  flow,\n  keys as lodashKeys,\n  map\n} from 'lodash/fp';\n\nconst getTransform = ({ fieldsToExport }) => {\n  const isEmptyObject = field =>\n    isObject(field) && !isDate(field) && isEmpty(field);\n  const isFieldToExport = (val, key) => indexOf(key, fieldsToExport) >= 0;\n  const removeEmptyObjects = doc => omitBy(isEmptyObject, doc);\n  const pickFieldsToExport = doc =>\n    fieldsToExport.length > 0 ? pickBy(isFieldToExport, doc) : doc;\n\n  const transform = flow(\n    map(flat),\n    map(pickFieldsToExport),\n    map(removeEmptyObjects)\n  );\n\n  return transform;\n};\n/* eslint import/prefer-default-export: 0*/\nexport const getExportSet = (allDocs, { fieldsToExport }) => {\n  const transform = getTransform({ fieldsToExport });\n  const data = transform(allDocs);\n\n  const keysSet = new Set();\n  data.forEach(entry => lodashKeys(entry).forEach(key => keysSet.add(key)));\n  const keys = [...keysSet.values()];\n  console.log(allDocs, fieldsToExport, keys);\n  return { data, keys };\n};\n"]}